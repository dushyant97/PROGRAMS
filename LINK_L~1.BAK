#include<stdio.h>
#include<conio.h>
#include<stdlib.h>

void beg_list();		//LIST OF FUNCTIONS
void given_node();
void sorted_list();
void display();
void free_pool();

struct node				//STRUCTURE DECLARATION
{
	int info;
	struct node *link;
};

struct node *start,* new1,*avail;	//GLOBAL VARIABLE


int main()
{
	int ch,choice;
	fflush(stdin);
	free_pool();
	start=avail;
	start->info=NULL;
	start->link=NULL;
	clrscr();
	do
	{
		MENU:
		{
			clrscr();
			printf("Where would you like to enter the elements:\n");
			printf("1.At the beginning of the list\n");
			printf("2.After a given node\n");
			printf("3.Into a sorted list\n");
			printf("4.Display the complete list\n");
			printf("5.Exit\n");
			scanf("%d",&ch);
			switch(ch)
			{
				case 1: beg_list();
						break;
				case 2:	given_node();
						break;
				case 3:	sorted_list();
						break;
				case 4: display();
						break;
				case 5: exit(0);
				default:printf("Wrong input. Try again\n");
						goto MENU;
			}
		}
		printf("\nDo you want to continue? 1 for yes or any key for no\n");
		scanf("%d",&choice);
	}
	while(choice==1);
}

void free_pool()
{
	avail = (struct node *) malloc (sizeof(struct node));
	if(avail==NULL)
	{
		printf("Overflow\n");
		exit(0);
	}
}

void beg_list()
{
	int input;
	struct node *new1;
	free_pool();
	new1=avail;
	printf("Enter the item which you want to enter");
	scanf("%d",&input);
	new1->info=input;
	new1->link=start->link;
	start->link=new1;
}

void given_node()
{
	int input,value;
	struct node *new1,*loc=NULL,*ptr=start;
	printf("Enter the value of node after which you want to insert the element\n");
	scanf("%d",&value);
	printf("Enter the value of new node");
	scanf("%d",&input);
	free_pool();
	new1=avail;
	new1->info=input;
	while(ptr->link!=NULL)
	{
		ptr=ptr->link;
		if(ptr->info==value)
		{
			loc=ptr;
		}
	}
	if(loc==NULL)
	{
		printf("Item not present in the list\n");
		printf("Inserting element at the beginning of the list\n");
		new1->link=start->link;
		start->link=new1;
		return;
	}
	new1->link=loc->link;
	loc->link=new1;
}

void sorted_list()
{
	int input;
	struct node *save,*ptr,*loc=NULL,*loc1=NULL;
	printf("Enter the value of new node\n");
	scanf("%d",&input);
	free_pool();
	new1=avail;
	new1->info=input;
	save=start;
	ptr=start->link;
	if(start->link==NULL || input<(ptr->info))
	{
		new1->link=start->link;
		start->link=new1;		
		return;
	}
	else
	{
		while(ptr!=NULL)
		{
			if(ptr->info>input)
			{
				loc=save;
				new1->link=loc->link;
				loc->link=new1;
				return;
			}
			save=ptr;
			ptr=ptr->link;
		}
		if(loc==NULL)
		{
		loc1=save;
		new1->link=loc1->link;
		loc1->link=new1;
		}	
	}
}

void display()
{
	struct node *ptr=start;
	if(ptr->link==NULL)
	{
		printf("No elements found in the list\n");
		return;
	}
	printf("The elements in the list are :\n");
	while(ptr->link!=NULL)
	{
		ptr=ptr->link;
		printf(" %d",ptr->info);
	}
}
